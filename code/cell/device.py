# -*- coding: utf-8 -*-
# -------------------------------------------------------------
# Two-probe Configuration
# -------------------------------------------------------------

# -------------------------------------------------------------
# Left Electrode
# -------------------------------------------------------------

# Set up lattice
vector_a = [16.3673, 0.0, 0.0]*Angstrom
vector_b = [0.0, -12.0347, 0.0]*Angstrom
vector_c = [0.0, 0.0, 4.07825]*Angstrom
left_electrode_lattice = UnitCell(vector_a, vector_b, vector_c)

# Define elements
left_electrode_elements = [Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold]

# Define coordinates
left_electrode_coordinates = [[  0.            ,   0.            ,   1.0195625     ],
                              [  4.091819712846,   0.            ,   1.0195625     ],
                              [  8.183639425692,   0.            ,   1.0195625     ],
                              [ 12.275459138538,   0.            ,   1.0195625     ],
                              [  2.045909856423,  -2.005775332294,   1.0195625     ],
                              [  6.137729569269,  -2.005775332294,   1.0195625     ],
                              [ 10.229549282115,  -2.005775332294,   1.0195625     ],
                              [ 14.321368994961,  -2.005775332294,   1.0195625     ],
                              [  0.            ,  -4.011550664587,   1.0195625     ],
                              [  4.091819712846,  -4.011550664587,   1.0195625     ],
                              [  8.183639425692,  -4.011550664587,   1.0195625     ],
                              [ 12.275459138538,  -4.011550664587,   1.0195625     ],
                              [  2.045909856423,  -6.017325996881,   1.0195625     ],
                              [  6.137729569269,  -6.017325996881,   1.0195625     ],
                              [ 10.229549282115,  -6.017325996881,   1.0195625     ],
                              [ 14.321368994961,  -6.017325996881,   1.0195625     ],
                              [  0.            ,  -8.023101329174,   1.0195625     ],
                              [  4.091819712846,  -8.023101329174,   1.0195625     ],
                              [  8.183639425692,  -8.023101329174,   1.0195625     ],
                              [ 12.275459138538,  -8.023101329174,   1.0195625     ],
                              [  2.045909856423, -10.028876661468,   1.0195625     ],
                              [  6.137729569269, -10.028876661468,   1.0195625     ],
                              [ 10.229549282115, -10.028876661468,   1.0195625     ],
                              [ 14.321368994961, -10.028876661468,   1.0195625     ],
                              [  2.045909856423,   0.            ,   3.0586875     ],
                              [  6.137729569269,   0.            ,   3.0586875     ],
                              [ 10.229549282115,   0.            ,   3.0586875     ],
                              [ 14.321368994961,   0.            ,   3.0586875     ],
                              [  0.            ,  -2.005775332294,   3.0586875     ],
                              [  4.091819712846,  -2.005775332294,   3.0586875     ],
                              [  8.183639425692,  -2.005775332294,   3.0586875     ],
                              [ 12.275459138538,  -2.005775332294,   3.0586875     ],
                              [  2.045909856423,  -4.011550664587,   3.0586875     ],
                              [  6.137729569269,  -4.011550664587,   3.0586875     ],
                              [ 10.229549282115,  -4.011550664587,   3.0586875     ],
                              [ 14.321368994961,  -4.011550664587,   3.0586875     ],
                              [  0.            ,  -6.017325996881,   3.0586875     ],
                              [  4.091819712846,  -6.017325996881,   3.0586875     ],
                              [  8.183639425692,  -6.017325996881,   3.0586875     ],
                              [ 12.275459138538,  -6.017325996881,   3.0586875     ],
                              [  2.045909856423,  -8.023101329174,   3.0586875     ],
                              [  6.137729569269,  -8.023101329174,   3.0586875     ],
                              [ 10.229549282115,  -8.023101329174,   3.0586875     ],
                              [ 14.321368994961,  -8.023101329174,   3.0586875     ],
                              [  0.            , -10.028876661468,   3.0586875     ],
                              [  4.091819712846, -10.028876661468,   3.0586875     ],
                              [  8.183639425692, -10.028876661468,   3.0586875     ],
                              [ 12.275459138538, -10.028876661468,   3.0586875     ]]*Angstrom

# Set up configuration
left_electrode = BulkConfiguration(
    bravais_lattice=left_electrode_lattice,
    elements=left_electrode_elements,
    cartesian_coordinates=left_electrode_coordinates
    )

# -------------------------------------------------------------
# Right Electrode
# -------------------------------------------------------------

# Set up lattice
vector_a = [16.3673, 0.0, 0.0]*Angstrom
vector_b = [0.0, -12.0347, 0.0]*Angstrom
vector_c = [0.0, 0.0, 4.078250000000001]*Angstrom
right_electrode_lattice = UnitCell(vector_a, vector_b, vector_c)

# Define elements
right_electrode_elements = [Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                            Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                            Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                            Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                            Gold, Gold, Gold, Gold]

# Define coordinates
right_electrode_coordinates = [[  0.            ,   0.            ,   1.0195625     ],
                               [  4.091819712846,   0.            ,   1.0195625     ],
                               [  8.183639425692,   0.            ,   1.0195625     ],
                               [ 12.275459138538,   0.            ,   1.0195625     ],
                               [  2.045909856423,  -2.005775332294,   1.0195625     ],
                               [  6.137729569269,  -2.005775332294,   1.0195625     ],
                               [ 10.229549282115,  -2.005775332294,   1.0195625     ],
                               [ 14.321368994961,  -2.005775332294,   1.0195625     ],
                               [  0.            ,  -4.011550664587,   1.0195625     ],
                               [  4.091819712846,  -4.011550664587,   1.0195625     ],
                               [  8.183639425692,  -4.011550664587,   1.0195625     ],
                               [ 12.275459138538,  -4.011550664587,   1.0195625     ],
                               [  2.045909856423,  -6.017325996881,   1.0195625     ],
                               [  6.137729569269,  -6.017325996881,   1.0195625     ],
                               [ 10.229549282115,  -6.017325996881,   1.0195625     ],
                               [ 14.321368994961,  -6.017325996881,   1.0195625     ],
                               [  0.            ,  -8.023101329174,   1.0195625     ],
                               [  4.091819712846,  -8.023101329174,   1.0195625     ],
                               [  8.183639425692,  -8.023101329174,   1.0195625     ],
                               [ 12.275459138538,  -8.023101329174,   1.0195625     ],
                               [  2.045909856423, -10.028876661468,   1.0195625     ],
                               [  6.137729569269, -10.028876661468,   1.0195625     ],
                               [ 10.229549282115, -10.028876661468,   1.0195625     ],
                               [ 14.321368994961, -10.028876661468,   1.0195625     ],
                               [  2.045909856423,   0.            ,   3.0586875     ],
                               [  6.137729569269,   0.            ,   3.0586875     ],
                               [ 10.229549282115,   0.            ,   3.0586875     ],
                               [ 14.321368994961,   0.            ,   3.0586875     ],
                               [  0.            ,  -2.005775332294,   3.0586875     ],
                               [  4.091819712846,  -2.005775332294,   3.0586875     ],
                               [  8.183639425692,  -2.005775332294,   3.0586875     ],
                               [ 12.275459138538,  -2.005775332294,   3.0586875     ],
                               [  2.045909856423,  -4.011550664587,   3.0586875     ],
                               [  6.137729569269,  -4.011550664587,   3.0586875     ],
                               [ 10.229549282115,  -4.011550664587,   3.0586875     ],
                               [ 14.321368994961,  -4.011550664587,   3.0586875     ],
                               [  0.            ,  -6.017325996881,   3.0586875     ],
                               [  4.091819712846,  -6.017325996881,   3.0586875     ],
                               [  8.183639425692,  -6.017325996881,   3.0586875     ],
                               [ 12.275459138538,  -6.017325996881,   3.0586875     ],
                               [  2.045909856423,  -8.023101329174,   3.0586875     ],
                               [  6.137729569269,  -8.023101329174,   3.0586875     ],
                               [ 10.229549282115,  -8.023101329174,   3.0586875     ],
                               [ 14.321368994961,  -8.023101329174,   3.0586875     ],
                               [  0.            , -10.028876661468,   3.0586875     ],
                               [  4.091819712846, -10.028876661468,   3.0586875     ],
                               [  8.183639425692, -10.028876661468,   3.0586875     ],
                               [ 12.275459138538, -10.028876661468,   3.0586875     ]]*Angstrom

# Set up configuration
right_electrode = BulkConfiguration(
    bravais_lattice=right_electrode_lattice,
    elements=right_electrode_elements,
    cartesian_coordinates=right_electrode_coordinates
    )

# -------------------------------------------------------------
# Central Region
# -------------------------------------------------------------

# Set up lattice
vector_a = [16.3673, 0.0, 0.0]*Angstrom
vector_b = [0.0, -12.0347, 0.0]*Angstrom
vector_c = [0.0, 0.0, 32.4695]*Angstrom
central_region_lattice = UnitCell(vector_a, vector_b, vector_c)

# Define elements
central_region_elements = [Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Sulfur, Sulfur, Sulfur, Sulfur, Sulfur, Sulfur, Sulfur,
                           Sulfur, Sulfur, Sulfur, Sulfur, Sulfur, Sulfur, Sulfur, Sulfur,
                           Sulfur, Sulfur, Sulfur, Sulfur, Sulfur, Sulfur, Sulfur, Sulfur,
                           Sulfur, Molybdenum, Molybdenum, Molybdenum, Molybdenum, Molybdenum,
                           Molybdenum, Molybdenum, Molybdenum, Molybdenum, Molybdenum,
                           Molybdenum, Molybdenum, Molybdenum, Molybdenum, Molybdenum,
                           Molybdenum, Molybdenum, Molybdenum, Molybdenum, Molybdenum,
                           Molybdenum, Molybdenum, Molybdenum, Molybdenum, Sulfur, Sulfur,
                           Sulfur, Sulfur, Sulfur, Sulfur, Sulfur, Sulfur, Sulfur, Sulfur,
                           Sulfur, Sulfur, Sulfur, Sulfur, Sulfur, Sulfur, Sulfur, Sulfur,
                           Sulfur, Sulfur, Sulfur, Sulfur, Sulfur, Sulfur, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold,
                           Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold, Gold]

# Define coordinates
central_region_coordinates = [[  0.            ,   0.            ,   1.0195625     ],
                              [  4.091819712846,   0.            ,   1.0195625     ],
                              [  8.183639425692,   0.            ,   1.0195625     ],
                              [ 12.275459138538,   0.            ,   1.0195625     ],
                              [  2.045909856423,  -2.005775332294,   1.0195625     ],
                              [  6.137729569269,  -2.005775332294,   1.0195625     ],
                              [ 10.229549282115,  -2.005775332294,   1.0195625     ],
                              [ 14.321368994961,  -2.005775332294,   1.0195625     ],
                              [  0.            ,  -4.011550664587,   1.0195625     ],
                              [  4.091819712846,  -4.011550664587,   1.0195625     ],
                              [  8.183639425692,  -4.011550664587,   1.0195625     ],
                              [ 12.275459138538,  -4.011550664587,   1.0195625     ],
                              [  2.045909856423,  -6.017325996881,   1.0195625     ],
                              [  6.137729569269,  -6.017325996881,   1.0195625     ],
                              [ 10.229549282115,  -6.017325996881,   1.0195625     ],
                              [ 14.321368994961,  -6.017325996881,   1.0195625     ],
                              [  0.            ,  -8.023101329174,   1.0195625     ],
                              [  4.091819712846,  -8.023101329174,   1.0195625     ],
                              [  8.183639425692,  -8.023101329174,   1.0195625     ],
                              [ 12.275459138538,  -8.023101329174,   1.0195625     ],
                              [  2.045909856423, -10.028876661468,   1.0195625     ],
                              [  6.137729569269, -10.028876661468,   1.0195625     ],
                              [ 10.229549282115, -10.028876661468,   1.0195625     ],
                              [ 14.321368994961, -10.028876661468,   1.0195625     ],
                              [  2.045909856423,   0.            ,   3.0586875     ],
                              [  6.137729569269,   0.            ,   3.0586875     ],
                              [ 10.229549282115,   0.            ,   3.0586875     ],
                              [ 14.321368994961,   0.            ,   3.0586875     ],
                              [  0.            ,  -2.005775332294,   3.0586875     ],
                              [  4.091819712846,  -2.005775332294,   3.0586875     ],
                              [  8.183639425692,  -2.005775332294,   3.0586875     ],
                              [ 12.275459138538,  -2.005775332294,   3.0586875     ],
                              [  2.045909856423,  -4.011550664587,   3.0586875     ],
                              [  6.137729569269,  -4.011550664587,   3.0586875     ],
                              [ 10.229549282115,  -4.011550664587,   3.0586875     ],
                              [ 14.321368994961,  -4.011550664587,   3.0586875     ],
                              [  0.            ,  -6.017325996881,   3.0586875     ],
                              [  4.091819712846,  -6.017325996881,   3.0586875     ],
                              [  8.183639425692,  -6.017325996881,   3.0586875     ],
                              [ 12.275459138538,  -6.017325996881,   3.0586875     ],
                              [  2.045909856423,  -8.023101329174,   3.0586875     ],
                              [  6.137729569269,  -8.023101329174,   3.0586875     ],
                              [ 10.229549282115,  -8.023101329174,   3.0586875     ],
                              [ 14.321368994961,  -8.023101329174,   3.0586875     ],
                              [  0.            , -10.028876661468,   3.0586875     ],
                              [  4.091819712846, -10.028876661468,   3.0586875     ],
                              [  8.183639425692, -10.028876661468,   3.0586875     ],
                              [ 12.275459138538, -10.028876661468,   3.0586875     ],
                              [  0.            ,   0.            ,   5.0978125     ],
                              [  4.091819712846,   0.            ,   5.0978125     ],
                              [  8.183639425692,   0.            ,   5.0978125     ],
                              [ 12.275459138538,   0.            ,   5.0978125     ],
                              [  2.045909856423,  -2.005775332294,   5.0978125     ],
                              [  6.137729569269,  -2.005775332294,   5.0978125     ],
                              [ 10.229549282115,  -2.005775332294,   5.0978125     ],
                              [ 14.321368994961,  -2.005775332294,   5.0978125     ],
                              [  0.            ,  -4.011550664587,   5.0978125     ],
                              [  4.091819712846,  -4.011550664587,   5.0978125     ],
                              [  8.183639425692,  -4.011550664587,   5.0978125     ],
                              [ 12.275459138538,  -4.011550664587,   5.0978125     ],
                              [  2.045909856423,  -6.017325996881,   5.0978125     ],
                              [  6.137729569269,  -6.017325996881,   5.0978125     ],
                              [ 10.229549282115,  -6.017325996881,   5.0978125     ],
                              [ 14.321368994961,  -6.017325996881,   5.0978125     ],
                              [  0.            ,  -8.023101329174,   5.0978125     ],
                              [  4.091819712846,  -8.023101329174,   5.0978125     ],
                              [  8.183639425692,  -8.023101329174,   5.0978125     ],
                              [ 12.275459138538,  -8.023101329174,   5.0978125     ],
                              [  2.045909856423, -10.028876661468,   5.0978125     ],
                              [  6.137729569269, -10.028876661468,   5.0978125     ],
                              [ 10.229549282115, -10.028876661468,   5.0978125     ],
                              [ 14.321368994961, -10.028876661468,   5.0978125     ],
                              [  2.045909856423,   0.            ,   7.1369375     ],
                              [  6.137729569269,   0.            ,   7.1369375     ],
                              [ 10.229549282115,   0.            ,   7.1369375     ],
                              [ 14.321368994961,   0.            ,   7.1369375     ],
                              [  0.            ,  -2.005775332294,   7.1369375     ],
                              [  4.091819712846,  -2.005775332294,   7.1369375     ],
                              [  8.183639425692,  -2.005775332294,   7.1369375     ],
                              [ 12.275459138538,  -2.005775332294,   7.1369375     ],
                              [  2.045909856423,  -4.011550664587,   7.1369375     ],
                              [  6.137729569269,  -4.011550664587,   7.1369375     ],
                              [ 10.229549282115,  -4.011550664587,   7.1369375     ],
                              [ 14.321368994961,  -4.011550664587,   7.1369375     ],
                              [  0.            ,  -6.017325996881,   7.1369375     ],
                              [  4.091819712846,  -6.017325996881,   7.1369375     ],
                              [  8.183639425692,  -6.017325996881,   7.1369375     ],
                              [ 12.275459138538,  -6.017325996881,   7.1369375     ],
                              [  2.045909856423,  -8.023101329174,   7.1369375     ],
                              [  6.137729569269,  -8.023101329174,   7.1369375     ],
                              [ 10.229549282115,  -8.023101329174,   7.1369375     ],
                              [ 14.321368994961,  -8.023101329174,   7.1369375     ],
                              [  0.            , -10.028876661468,   7.1369375     ],
                              [  4.091819712846, -10.028876661468,   7.1369375     ],
                              [  8.183639425692, -10.028876661468,   7.1369375     ],
                              [ 12.275459138538, -10.028876661468,   7.1369375     ],
                              [  0.            ,   0.            ,   9.1760625     ],
                              [  4.091819712846,   0.            ,   9.1760625     ],
                              [  8.183639425692,   0.            ,   9.1760625     ],
                              [ 12.275459138538,   0.            ,   9.1760625     ],
                              [  2.045909856423,  -2.005775332294,   9.1760625     ],
                              [  6.137729569269,  -2.005775332294,   9.1760625     ],
                              [ 10.229549282115,  -2.005775332294,   9.1760625     ],
                              [ 14.321368994961,  -2.005775332294,   9.1760625     ],
                              [  0.            ,  -4.011550664587,   9.1760625     ],
                              [  4.091819712846,  -4.011550664587,   9.1760625     ],
                              [  8.183639425692,  -4.011550664587,   9.1760625     ],
                              [ 12.275459138538,  -4.011550664587,   9.1760625     ],
                              [  2.045909856423,  -6.017325996881,   9.1760625     ],
                              [  6.137729569269,  -6.017325996881,   9.1760625     ],
                              [ 10.229549282115,  -6.017325996881,   9.1760625     ],
                              [ 14.321368994961,  -6.017325996881,   9.1760625     ],
                              [  0.            ,  -8.023101329174,   9.1760625     ],
                              [  4.091819712846,  -8.023101329174,   9.1760625     ],
                              [  8.183639425692,  -8.023101329174,   9.1760625     ],
                              [ 12.275459138538,  -8.023101329174,   9.1760625     ],
                              [  2.045909856423, -10.028876661468,   9.1760625     ],
                              [  6.137729569269, -10.028876661468,   9.1760625     ],
                              [ 10.229549282115, -10.028876661468,   9.1760625     ],
                              [ 14.321368994961, -10.028876661468,   9.1760625     ],
                              [  2.045909856423,   0.            ,  11.2151875     ],
                              [  6.137729569269,   0.            ,  11.2151875     ],
                              [ 10.229549282115,   0.            ,  11.2151875     ],
                              [ 14.321368994961,   0.            ,  11.2151875     ],
                              [  0.            ,  -2.005775332294,  11.2151875     ],
                              [  4.091819712846,  -2.005775332294,  11.2151875     ],
                              [  8.183639425692,  -2.005775332294,  11.2151875     ],
                              [ 12.275459138538,  -2.005775332294,  11.2151875     ],
                              [  2.045909856423,  -4.011550664587,  11.2151875     ],
                              [  6.137729569269,  -4.011550664587,  11.2151875     ],
                              [ 10.229549282115,  -4.011550664587,  11.2151875     ],
                              [ 14.321368994961,  -4.011550664587,  11.2151875     ],
                              [  0.            ,  -6.017325996881,  11.2151875     ],
                              [  4.091819712846,  -6.017325996881,  11.2151875     ],
                              [  8.183639425692,  -6.017325996881,  11.2151875     ],
                              [ 12.275459138538,  -6.017325996881,  11.2151875     ],
                              [  2.045909856423,  -8.023101329174,  11.2151875     ],
                              [  6.137729569269,  -8.023101329174,  11.2151875     ],
                              [ 10.229549282115,  -8.023101329174,  11.2151875     ],
                              [ 14.321368994961,  -8.023101329174,  11.2151875     ],
                              [  0.            , -10.028876661468,  11.2151875     ],
                              [  4.091819712846, -10.028876661468,  11.2151875     ],
                              [  8.183639425692, -10.028876661468,  11.2151875     ],
                              [ 12.275459138538, -10.028876661468,  11.2151875     ],
                              [  3.756979985571,   0.            ,  15.001335334262],
                              [  9.212739602699,   0.            ,  15.001335334262],
                              [ 14.668499219827,   0.            ,  15.001335334262],
                              [  1.029100177007,  -1.50433149922 ,  15.001335334262],
                              [  6.484859794135,  -1.50433149922 ,  15.001335334262],
                              [ 11.940619411263,  -1.50433149922 ,  15.001335334262],
                              [  3.756979985571,  -3.00866299844 ,  15.001335334262],
                              [  9.212739602699,  -3.00866299844 ,  15.001335334262],
                              [ 14.668499219827,  -3.00866299844 ,  15.001335334262],
                              [  1.029100177007,  -4.512994497661,  15.001335334262],
                              [  6.484859794135,  -4.512994497661,  15.001335334262],
                              [ 11.940619411263,  -4.512994497661,  15.001335334262],
                              [  3.756979985571,  -6.017325996881,  15.001335334262],
                              [  9.212739602699,  -6.017325996881,  15.001335334262],
                              [ 14.668499219827,  -6.017325996881,  15.001335334262],
                              [  1.029100177007,  -7.521657496101,  15.001335334262],
                              [  6.484859794135,  -7.521657496101,  15.001335334262],
                              [ 11.940619411263,  -7.521657496101,  15.001335334262],
                              [  3.756979985571,  -9.025988995321,  15.001335334262],
                              [  9.212739602699,  -9.025988995321,  15.001335334262],
                              [ 14.668499219827,  -9.025988995321,  15.001335334262],
                              [  1.029100177007, -10.530320494541,  15.001335334262],
                              [  6.484859794135, -10.530320494541,  15.001335334262],
                              [ 11.940619411263, -10.530320494541,  15.001335334262],
                              [  1.938393446528,   0.            ,  16.587390334262],
                              [  7.394153063656,   0.            ,  16.587390334262],
                              [ 12.849912680784,   0.            ,  16.587390334262],
                              [  4.666273255092,  -1.50433149922 ,  16.587390334262],
                              [ 10.12203287222 ,  -1.50433149922 ,  16.587390334262],
                              [ 15.577792489348,  -1.50433149922 ,  16.587390334262],
                              [  1.938393446528,  -3.00866299844 ,  16.587390334262],
                              [  7.394153063656,  -3.00866299844 ,  16.587390334262],
                              [ 12.849912680784,  -3.00866299844 ,  16.587390334262],
                              [  4.666273255092,  -4.512994497661,  16.587390334262],
                              [ 10.12203287222 ,  -4.512994497661,  16.587390334262],
                              [ 15.577792489348,  -4.512994497661,  16.587390334262],
                              [  1.938393446528,  -6.017325996881,  16.587390334262],
                              [  7.394153063656,  -6.017325996881,  16.587390334262],
                              [ 12.849912680784,  -6.017325996881,  16.587390334262],
                              [  4.666273255092,  -7.521657496101,  16.587390334262],
                              [ 10.12203287222 ,  -7.521657496101,  16.587390334262],
                              [ 15.577792489348,  -7.521657496101,  16.587390334262],
                              [  1.938393446528,  -9.025988995321,  16.587390334262],
                              [  7.394153063656,  -9.025988995321,  16.587390334262],
                              [ 12.849912680784,  -9.025988995321,  16.587390334262],
                              [  4.666273255092, -10.530320494541,  16.587390334262],
                              [ 10.12203287222 , -10.530320494541,  16.587390334262],
                              [ 15.577792489348, -10.530320494541,  16.587390334262],
                              [  3.756979985571,   0.            ,  18.173445334262],
                              [  9.212739602699,   0.            ,  18.173445334262],
                              [ 14.668499219827,   0.            ,  18.173445334262],
                              [  1.029100177007,  -1.50433149922 ,  18.173445334262],
                              [  6.484859794135,  -1.50433149922 ,  18.173445334262],
                              [ 11.940619411263,  -1.50433149922 ,  18.173445334262],
                              [  3.756979985571,  -3.00866299844 ,  18.173445334262],
                              [  9.212739602699,  -3.00866299844 ,  18.173445334262],
                              [ 14.668499219827,  -3.00866299844 ,  18.173445334262],
                              [  1.029100177007,  -4.512994497661,  18.173445334262],
                              [  6.484859794135,  -4.512994497661,  18.173445334262],
                              [ 11.940619411263,  -4.512994497661,  18.173445334262],
                              [  3.756979985571,  -6.017325996881,  18.173445334262],
                              [  9.212739602699,  -6.017325996881,  18.173445334262],
                              [ 14.668499219827,  -6.017325996881,  18.173445334262],
                              [  1.029100177007,  -7.521657496101,  18.173445334262],
                              [  6.484859794135,  -7.521657496101,  18.173445334262],
                              [ 11.940619411263,  -7.521657496101,  18.173445334262],
                              [  3.756979985571,  -9.025988995321,  18.173445334262],
                              [  9.212739602699,  -9.025988995321,  18.173445334262],
                              [ 14.668499219827,  -9.025988995321,  18.173445334262],
                              [  1.029100177007, -10.530320494541,  18.173445334262],
                              [  6.484859794135, -10.530320494541,  18.173445334262],
                              [ 11.940619411263, -10.530320494541,  18.173445334262],
                              [  0.            ,   0.            ,  21.2543125     ],
                              [  4.091819712846,   0.            ,  21.2543125     ],
                              [  8.183639425692,   0.            ,  21.2543125     ],
                              [ 12.275459138538,   0.            ,  21.2543125     ],
                              [  2.045909856423,  -2.005775332294,  21.2543125     ],
                              [  6.137729569269,  -2.005775332294,  21.2543125     ],
                              [ 10.229549282115,  -2.005775332294,  21.2543125     ],
                              [ 14.321368994961,  -2.005775332294,  21.2543125     ],
                              [  0.            ,  -4.011550664587,  21.2543125     ],
                              [  4.091819712846,  -4.011550664587,  21.2543125     ],
                              [  8.183639425692,  -4.011550664587,  21.2543125     ],
                              [ 12.275459138538,  -4.011550664587,  21.2543125     ],
                              [  2.045909856423,  -6.017325996881,  21.2543125     ],
                              [  6.137729569269,  -6.017325996881,  21.2543125     ],
                              [ 10.229549282115,  -6.017325996881,  21.2543125     ],
                              [ 14.321368994961,  -6.017325996881,  21.2543125     ],
                              [  0.            ,  -8.023101329174,  21.2543125     ],
                              [  4.091819712846,  -8.023101329174,  21.2543125     ],
                              [  8.183639425692,  -8.023101329174,  21.2543125     ],
                              [ 12.275459138538,  -8.023101329174,  21.2543125     ],
                              [  2.045909856423, -10.028876661468,  21.2543125     ],
                              [  6.137729569269, -10.028876661468,  21.2543125     ],
                              [ 10.229549282115, -10.028876661468,  21.2543125     ],
                              [ 14.321368994961, -10.028876661468,  21.2543125     ],
                              [  2.045909856423,   0.            ,  23.2934375     ],
                              [  6.137729569269,   0.            ,  23.2934375     ],
                              [ 10.229549282115,   0.            ,  23.2934375     ],
                              [ 14.321368994961,   0.            ,  23.2934375     ],
                              [  0.            ,  -2.005775332294,  23.2934375     ],
                              [  4.091819712846,  -2.005775332294,  23.2934375     ],
                              [  8.183639425692,  -2.005775332294,  23.2934375     ],
                              [ 12.275459138538,  -2.005775332294,  23.2934375     ],
                              [  2.045909856423,  -4.011550664587,  23.2934375     ],
                              [  6.137729569269,  -4.011550664587,  23.2934375     ],
                              [ 10.229549282115,  -4.011550664587,  23.2934375     ],
                              [ 14.321368994961,  -4.011550664587,  23.2934375     ],
                              [  0.            ,  -6.017325996881,  23.2934375     ],
                              [  4.091819712846,  -6.017325996881,  23.2934375     ],
                              [  8.183639425692,  -6.017325996881,  23.2934375     ],
                              [ 12.275459138538,  -6.017325996881,  23.2934375     ],
                              [  2.045909856423,  -8.023101329174,  23.2934375     ],
                              [  6.137729569269,  -8.023101329174,  23.2934375     ],
                              [ 10.229549282115,  -8.023101329174,  23.2934375     ],
                              [ 14.321368994961,  -8.023101329174,  23.2934375     ],
                              [  0.            , -10.028876661468,  23.2934375     ],
                              [  4.091819712846, -10.028876661468,  23.2934375     ],
                              [  8.183639425692, -10.028876661468,  23.2934375     ],
                              [ 12.275459138538, -10.028876661468,  23.2934375     ],
                              [  0.            ,   0.            ,  25.3325625     ],
                              [  4.091819712846,   0.            ,  25.3325625     ],
                              [  8.183639425692,   0.            ,  25.3325625     ],
                              [ 12.275459138538,   0.            ,  25.3325625     ],
                              [  2.045909856423,  -2.005775332294,  25.3325625     ],
                              [  6.137729569269,  -2.005775332294,  25.3325625     ],
                              [ 10.229549282115,  -2.005775332294,  25.3325625     ],
                              [ 14.321368994961,  -2.005775332294,  25.3325625     ],
                              [  0.            ,  -4.011550664587,  25.3325625     ],
                              [  4.091819712846,  -4.011550664587,  25.3325625     ],
                              [  8.183639425692,  -4.011550664587,  25.3325625     ],
                              [ 12.275459138538,  -4.011550664587,  25.3325625     ],
                              [  2.045909856423,  -6.017325996881,  25.3325625     ],
                              [  6.137729569269,  -6.017325996881,  25.3325625     ],
                              [ 10.229549282115,  -6.017325996881,  25.3325625     ],
                              [ 14.321368994961,  -6.017325996881,  25.3325625     ],
                              [  0.            ,  -8.023101329174,  25.3325625     ],
                              [  4.091819712846,  -8.023101329174,  25.3325625     ],
                              [  8.183639425692,  -8.023101329174,  25.3325625     ],
                              [ 12.275459138538,  -8.023101329174,  25.3325625     ],
                              [  2.045909856423, -10.028876661468,  25.3325625     ],
                              [  6.137729569269, -10.028876661468,  25.3325625     ],
                              [ 10.229549282115, -10.028876661468,  25.3325625     ],
                              [ 14.321368994961, -10.028876661468,  25.3325625     ],
                              [  2.045909856423,   0.            ,  27.3716875     ],
                              [  6.137729569269,   0.            ,  27.3716875     ],
                              [ 10.229549282115,   0.            ,  27.3716875     ],
                              [ 14.321368994961,   0.            ,  27.3716875     ],
                              [  0.            ,  -2.005775332294,  27.3716875     ],
                              [  4.091819712846,  -2.005775332294,  27.3716875     ],
                              [  8.183639425692,  -2.005775332294,  27.3716875     ],
                              [ 12.275459138538,  -2.005775332294,  27.3716875     ],
                              [  2.045909856423,  -4.011550664587,  27.3716875     ],
                              [  6.137729569269,  -4.011550664587,  27.3716875     ],
                              [ 10.229549282115,  -4.011550664587,  27.3716875     ],
                              [ 14.321368994961,  -4.011550664587,  27.3716875     ],
                              [  0.            ,  -6.017325996881,  27.3716875     ],
                              [  4.091819712846,  -6.017325996881,  27.3716875     ],
                              [  8.183639425692,  -6.017325996881,  27.3716875     ],
                              [ 12.275459138538,  -6.017325996881,  27.3716875     ],
                              [  2.045909856423,  -8.023101329174,  27.3716875     ],
                              [  6.137729569269,  -8.023101329174,  27.3716875     ],
                              [ 10.229549282115,  -8.023101329174,  27.3716875     ],
                              [ 14.321368994961,  -8.023101329174,  27.3716875     ],
                              [  0.            , -10.028876661468,  27.3716875     ],
                              [  4.091819712846, -10.028876661468,  27.3716875     ],
                              [  8.183639425692, -10.028876661468,  27.3716875     ],
                              [ 12.275459138538, -10.028876661468,  27.3716875     ],
                              [  0.            ,   0.            ,  29.4108125     ],
                              [  4.091819712846,   0.            ,  29.4108125     ],
                              [  8.183639425692,   0.            ,  29.4108125     ],
                              [ 12.275459138538,   0.            ,  29.4108125     ],
                              [  2.045909856423,  -2.005775332294,  29.4108125     ],
                              [  6.137729569269,  -2.005775332294,  29.4108125     ],
                              [ 10.229549282115,  -2.005775332294,  29.4108125     ],
                              [ 14.321368994961,  -2.005775332294,  29.4108125     ],
                              [  0.            ,  -4.011550664587,  29.4108125     ],
                              [  4.091819712846,  -4.011550664587,  29.4108125     ],
                              [  8.183639425692,  -4.011550664587,  29.4108125     ],
                              [ 12.275459138538,  -4.011550664587,  29.4108125     ],
                              [  2.045909856423,  -6.017325996881,  29.4108125     ],
                              [  6.137729569269,  -6.017325996881,  29.4108125     ],
                              [ 10.229549282115,  -6.017325996881,  29.4108125     ],
                              [ 14.321368994961,  -6.017325996881,  29.4108125     ],
                              [  0.            ,  -8.023101329174,  29.4108125     ],
                              [  4.091819712846,  -8.023101329174,  29.4108125     ],
                              [  8.183639425692,  -8.023101329174,  29.4108125     ],
                              [ 12.275459138538,  -8.023101329174,  29.4108125     ],
                              [  2.045909856423, -10.028876661468,  29.4108125     ],
                              [  6.137729569269, -10.028876661468,  29.4108125     ],
                              [ 10.229549282115, -10.028876661468,  29.4108125     ],
                              [ 14.321368994961, -10.028876661468,  29.4108125     ],
                              [  2.045909856423,   0.            ,  31.4499375     ],
                              [  6.137729569269,   0.            ,  31.4499375     ],
                              [ 10.229549282115,   0.            ,  31.4499375     ],
                              [ 14.321368994961,   0.            ,  31.4499375     ],
                              [  0.            ,  -2.005775332294,  31.4499375     ],
                              [  4.091819712846,  -2.005775332294,  31.4499375     ],
                              [  8.183639425692,  -2.005775332294,  31.4499375     ],
                              [ 12.275459138538,  -2.005775332294,  31.4499375     ],
                              [  2.045909856423,  -4.011550664587,  31.4499375     ],
                              [  6.137729569269,  -4.011550664587,  31.4499375     ],
                              [ 10.229549282115,  -4.011550664587,  31.4499375     ],
                              [ 14.321368994961,  -4.011550664587,  31.4499375     ],
                              [  0.            ,  -6.017325996881,  31.4499375     ],
                              [  4.091819712846,  -6.017325996881,  31.4499375     ],
                              [  8.183639425692,  -6.017325996881,  31.4499375     ],
                              [ 12.275459138538,  -6.017325996881,  31.4499375     ],
                              [  2.045909856423,  -8.023101329174,  31.4499375     ],
                              [  6.137729569269,  -8.023101329174,  31.4499375     ],
                              [ 10.229549282115,  -8.023101329174,  31.4499375     ],
                              [ 14.321368994961,  -8.023101329174,  31.4499375     ],
                              [  0.            , -10.028876661468,  31.4499375     ],
                              [  4.091819712846, -10.028876661468,  31.4499375     ],
                              [  8.183639425692, -10.028876661468,  31.4499375     ],
                              [ 12.275459138538, -10.028876661468,  31.4499375     ]]*Angstrom

# Set up configuration
central_region = BulkConfiguration(
    bravais_lattice=central_region_lattice,
    elements=central_region_elements,
    cartesian_coordinates=central_region_coordinates
    )

device_configuration = DeviceConfiguration(
    central_region,
    [left_electrode, right_electrode],
    equivalent_electrode_lengths=[8.1565, 8.1565]*Angstrom,
    transverse_electrode_repetitions=[[1, 1], [1, 1]],
    )

# Add tags
device_configuration.addTags('Left Interface 0',  [  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
                                                    10,  11,  12,  13,  14,  15,  16,  17,  18,  19,
                                                    20,  21,  22,  23,  24,  25,  26,  27,  28,  29,
                                                    30,  31,  32,  33,  34,  35,  36,  37,  38,  39,
                                                    40,  41,  42,  43,  44,  45,  46,  47,  48,  49,
                                                    50,  51,  52,  53,  54,  55,  56,  57,  58,  59,
                                                    60,  61,  62,  63,  64,  65,  66,  67,  68,  69,
                                                    70,  71,  72,  73,  74,  75,  76,  77,  78,  79,
                                                    80,  81,  82,  83,  84,  85,  86,  87,  88,  89,
                                                    90,  91,  92,  93,  94,  95,  96,  97,  98,  99,
                                                   100, 101, 102, 103, 104, 105, 106, 107, 108, 109,
                                                   110, 111, 112, 113, 114, 115, 116, 117, 118, 119,
                                                   120, 121, 122, 123, 124, 125, 126, 127, 128, 129,
                                                   130, 131, 132, 133, 134, 135, 136, 137, 138, 139,
                                                   140, 141, 142, 143, 216, 217, 218, 219, 220, 221,
                                                   222, 223, 224, 225, 226, 227, 228, 229, 230, 231,
                                                   232, 233, 234, 235, 236, 237, 238, 239, 240, 241,
                                                   242, 243, 244, 245, 246, 247, 248, 249, 250, 251,
                                                   252, 253, 254, 255, 256, 257, 258, 259, 260, 261,
                                                   262, 263, 264, 265, 266, 267, 268, 269, 270, 271,
                                                   272, 273, 274, 275, 276, 277, 278, 279, 280, 281,
                                                   282, 283, 284, 285, 286, 287, 288, 289, 290, 291,
                                                   292, 293, 294, 295, 296, 297, 298, 299, 300, 301,
                                                   302, 303, 304, 305, 306, 307, 308, 309, 310, 311,
                                                   312, 313, 314, 315, 316, 317, 318, 319, 320, 321,
                                                   322, 323, 324, 325, 326, 327, 328, 329, 330, 331,
                                                   332, 333, 334, 335, 336, 337, 338, 339, 340, 341,
                                                   342, 343, 344, 345, 346, 347, 348, 349, 350, 351,
                                                   352, 353, 354, 355, 356, 357, 358, 359])
device_configuration.addTags('Right Interface 0', [144, 145, 146, 147, 148, 149, 150, 151, 152, 153,
                                                   154, 155, 156, 157, 158, 159, 160, 161, 162, 163,
                                                   164, 165, 166, 167, 168, 169, 170, 171, 172, 173,
                                                   174, 175, 176, 177, 178, 179, 180, 181, 182, 183,
                                                   184, 185, 186, 187, 188, 189, 190, 191, 192, 193,
                                                   194, 195, 196, 197, 198, 199, 200, 201, 202, 203,
                                                   204, 205, 206, 207, 208, 209, 210, 211, 212, 213,
                                                   214, 215])

# -------------------------------------------------------------
# Calculator
# -------------------------------------------------------------
#----------------------------------------
# Basis Set
#----------------------------------------

# Basis set for Sulfur

sulfur_3p = ConfinedOrbital(
    principal_quantum_number=3,
    angular_momentum=1,
    radial_cutoff_radius=5.58618376198*Bohr,
    confinement_start_radius=4.46894700958*Bohr,
    additional_charge=0,
    confinement_strength=17.9013087039*Hartree,
    confinement_power=1,
    radial_step_size=0.001*Bohr,
    )

sulfur_3p = ConfinedOrbital(
    principal_quantum_number=3,
    angular_momentum=1,
    radial_cutoff_radius=5.58618376198*Bohr,
    confinement_start_radius=4.46894700958*Bohr,
    additional_charge=0,
    confinement_strength=17.9013087039*Hartree,
    confinement_power=1,
    radial_step_size=0.001*Bohr,
    )

sulfur_3p_polarization = PolarizationOrbital(sulfur_3p)

sulfur_3p = ConfinedOrbital(
    principal_quantum_number=3,
    angular_momentum=1,
    radial_cutoff_radius=5.58618376198*Bohr,
    confinement_start_radius=4.46894700958*Bohr,
    additional_charge=0,
    confinement_strength=17.9013087039*Hartree,
    confinement_power=1,
    radial_step_size=0.001*Bohr,
    )

sulfur_3p_split = AnalyticalSplit(sulfur_3p, split_norm=0.15)

sulfur_3s = ConfinedOrbital(
    principal_quantum_number=3,
    angular_momentum=0,
    radial_cutoff_radius=4.51478507146*Bohr,
    confinement_start_radius=3.61182805717*Bohr,
    additional_charge=0,
    confinement_strength=22.1494486265*Hartree,
    confinement_power=1,
    radial_step_size=0.001*Bohr,
    )

sulfur_3s = ConfinedOrbital(
    principal_quantum_number=3,
    angular_momentum=0,
    radial_cutoff_radius=4.51478507146*Bohr,
    confinement_start_radius=3.61182805717*Bohr,
    additional_charge=0,
    confinement_strength=22.1494486265*Hartree,
    confinement_power=1,
    radial_step_size=0.001*Bohr,
    )

sulfur_3s_split = AnalyticalSplit(sulfur_3s, split_norm=0.15)

SulfurBasis = BasisSet(
    element=PeriodicTable.Sulfur,
    orbitals=[sulfur_3s, sulfur_3p, sulfur_3s_split, sulfur_3p_split, sulfur_3p_polarization],
    occupations=[2.0, 4.0, 0.0, 0.0, 0.0],
    hubbard_u=[0.0, 0.0, 0.0, 0.0, 0.0]*eV,
    dft_half_parameters=Automatic,
    filling_method=SphericalSymmetric,
    onsite_spin_orbit_split=[0.0, 0.0, 0.0, 0.0, 0.0]*eV,
    pseudopotential=NormConservingPseudoPotential("normconserving/S.GGAPBE.zip"),
    )


# Basis set for Molybdenum

molybdenum_4d = ConfinedOrbital(
    principal_quantum_number=4,
    angular_momentum=2,
    radial_cutoff_radius=5.94363171581*Bohr,
    confinement_start_radius=4.75490537265*Bohr,
    additional_charge=0,
    confinement_strength=16.8247301955*Hartree,
    confinement_power=1,
    radial_step_size=0.001*Bohr,
    )

molybdenum_4d = ConfinedOrbital(
    principal_quantum_number=4,
    angular_momentum=2,
    radial_cutoff_radius=5.94363171581*Bohr,
    confinement_start_radius=4.75490537265*Bohr,
    additional_charge=0,
    confinement_strength=16.8247301955*Hartree,
    confinement_power=1,
    radial_step_size=0.001*Bohr,
    )

molybdenum_4d_split = AnalyticalSplit(molybdenum_4d, split_norm=0.15)

molybdenum_5s = ConfinedOrbital(
    principal_quantum_number=5,
    angular_momentum=0,
    radial_cutoff_radius=7.94602904419*Bohr,
    confinement_start_radius=6.35682323535*Bohr,
    additional_charge=0,
    confinement_strength=12.5849024014*Hartree,
    confinement_power=1,
    radial_step_size=0.001*Bohr,
    )

molybdenum_5s = ConfinedOrbital(
    principal_quantum_number=5,
    angular_momentum=0,
    radial_cutoff_radius=7.94602904419*Bohr,
    confinement_start_radius=6.35682323535*Bohr,
    additional_charge=0,
    confinement_strength=12.5849024014*Hartree,
    confinement_power=1,
    radial_step_size=0.001*Bohr,
    )

molybdenum_5s_polarization = PolarizationOrbital(molybdenum_5s)

molybdenum_5s = ConfinedOrbital(
    principal_quantum_number=5,
    angular_momentum=0,
    radial_cutoff_radius=7.94602904419*Bohr,
    confinement_start_radius=6.35682323535*Bohr,
    additional_charge=0,
    confinement_strength=12.5849024014*Hartree,
    confinement_power=1,
    radial_step_size=0.001*Bohr,
    )

molybdenum_5s_split = AnalyticalSplit(molybdenum_5s, split_norm=0.15)

MolybdenumBasis = BasisSet(
    element=PeriodicTable.Molybdenum,
    orbitals=[molybdenum_4d, molybdenum_5s, molybdenum_4d_split, molybdenum_5s_split, molybdenum_5s_polarization],
    occupations=[5.0, 1.0, 0.0, 0.0, 0.0],
    hubbard_u=[0.0, 0.0, 0.0, 0.0, 0.0]*eV,
    dft_half_parameters=Automatic,
    filling_method=SphericalSymmetric,
    onsite_spin_orbit_split=[0.0, 0.0, 0.0, 0.0, 0.0]*eV,
    pseudopotential=NormConservingPseudoPotential("normconserving/MO.GGAPBE.zip"),
    )


# Basis set for Gold

gold_5d = ConfinedOrbital(
    principal_quantum_number=5,
    angular_momentum=2,
    radial_cutoff_radius=4.97009209077*Bohr,
    confinement_start_radius=3.97607367262*Bohr,
    additional_charge=0,
    confinement_strength=20.1203515294*Hartree,
    confinement_power=1,
    radial_step_size=0.001*Bohr,
    )

gold_5d = ConfinedOrbital(
    principal_quantum_number=5,
    angular_momentum=2,
    radial_cutoff_radius=4.97009209077*Bohr,
    confinement_start_radius=3.97607367262*Bohr,
    additional_charge=0,
    confinement_strength=20.1203515294*Hartree,
    confinement_power=1,
    radial_step_size=0.001*Bohr,
    )

gold_5d_split = AnalyticalSplit(gold_5d, split_norm=0.15)

gold_6s = ConfinedOrbital(
    principal_quantum_number=6,
    angular_momentum=0,
    radial_cutoff_radius=6.80550732918*Bohr,
    confinement_start_radius=5.44440586334*Bohr,
    additional_charge=0,
    confinement_strength=14.6939816773*Hartree,
    confinement_power=1,
    radial_step_size=0.001*Bohr,
    )

gold_6s = ConfinedOrbital(
    principal_quantum_number=6,
    angular_momentum=0,
    radial_cutoff_radius=6.80550732918*Bohr,
    confinement_start_radius=5.44440586334*Bohr,
    additional_charge=0,
    confinement_strength=14.6939816773*Hartree,
    confinement_power=1,
    radial_step_size=0.001*Bohr,
    )

gold_6s_polarization = PolarizationOrbital(gold_6s)

gold_6s = ConfinedOrbital(
    principal_quantum_number=6,
    angular_momentum=0,
    radial_cutoff_radius=6.80550732918*Bohr,
    confinement_start_radius=5.44440586334*Bohr,
    additional_charge=0,
    confinement_strength=14.6939816773*Hartree,
    confinement_power=1,
    radial_step_size=0.001*Bohr,
    )

gold_6s_split = AnalyticalSplit(gold_6s, split_norm=0.15)

GoldBasis = BasisSet(
    element=PeriodicTable.Gold,
    orbitals=[gold_5d, gold_6s, gold_5d_split, gold_6s_split, gold_6s_polarization],
    occupations=[10.0, 1.0, 0.0, 0.0, 0.0],
    hubbard_u=[0.0, 0.0, 0.0, 0.0, 0.0]*eV,
    dft_half_parameters=Automatic,
    filling_method=SphericalSymmetric,
    onsite_spin_orbit_split=[0.0, 0.0, 0.0, 0.0, 0.0]*eV,
    pseudopotential=NormConservingPseudoPotential("normconserving/AU.GGAPBE.zip"),
    )

basis_set = [
    SulfurBasis,
    MolybdenumBasis,
    GoldBasis,
    ]

#----------------------------------------
# Exchange-Correlation
#----------------------------------------
exchange_correlation = GGA.PBE

#----------------------------------------
# Numerical Accuracy Settings
#----------------------------------------
left_electrode_k_point_sampling = MonkhorstPackGrid(
    na=2,
    nb=3,
    nc=232,
    symmetries=[
        ([[ 1., 0., 0.],
          [ 0., 1., 0.],
          [ 0., 0., 1.]], [ 0., 0., 0.]),
        ([[-1., 0., 0.],
          [ 0.,-1., 0.],
          [ 0., 0.,-1.]], [ 0., 0., 0.]),
        ],
    force_timereversal=True,
    shift_to_gamma=[True, True, True],
    )
left_electrode_exact_exchange_parameters = ExactExchangeParameters(
    aux_basis_tolerance=0.001,
    number_of_waves=1024,
    maximum_wave_vector=50.0,
    integral_tolerance=0.0001,
    relative_screening_tolerance=0.01,
    )
left_electrode_numerical_accuracy_parameters = NumericalAccuracyParameters(
    density_mesh_cutoff=60.0*Hartree,
    k_point_sampling=left_electrode_k_point_sampling,
    radial_step_size=0.001*Bohr,
    density_cutoff=1e-06,
    interaction_max_range=20.0*Angstrom,
    number_of_reciprocal_points=1024,
    reciprocal_energy_cutoff=1250.0*Hartree,
    occupation_method=FermiDirac(1000.0*Kelvin*boltzmann_constant),
    exact_exchange_parameters=left_electrode_exact_exchange_parameters,
    compensation_charge_mesh_cutoff=75.0*Hartree,
    )

right_electrode_k_point_sampling = MonkhorstPackGrid(
    na=2,
    nb=3,
    nc=232,
    symmetries=[
        ([[ 1., 0., 0.],
          [ 0., 1., 0.],
          [ 0., 0., 1.]], [ 0., 0., 0.]),
        ([[-1., 0., 0.],
          [ 0.,-1., 0.],
          [ 0., 0.,-1.]], [ 0., 0., 0.]),
        ],
    force_timereversal=True,
    shift_to_gamma=[True, True, True],
    )
right_electrode_exact_exchange_parameters = ExactExchangeParameters(
    aux_basis_tolerance=0.001,
    number_of_waves=1024,
    maximum_wave_vector=50.0,
    integral_tolerance=0.0001,
    relative_screening_tolerance=0.01,
    )
right_electrode_numerical_accuracy_parameters = NumericalAccuracyParameters(
    density_mesh_cutoff=60.0*Hartree,
    k_point_sampling=right_electrode_k_point_sampling,
    radial_step_size=0.001*Bohr,
    density_cutoff=1e-06,
    interaction_max_range=20.0*Angstrom,
    number_of_reciprocal_points=1024,
    reciprocal_energy_cutoff=1250.0*Hartree,
    occupation_method=FermiDirac(1000.0*Kelvin*boltzmann_constant),
    exact_exchange_parameters=right_electrode_exact_exchange_parameters,
    compensation_charge_mesh_cutoff=75.0*Hartree,
    )

device_k_point_sampling = KpointDensity(
    density_a=4.0*Angstrom,
    density_b=4.0*Angstrom,
    density_c=150.0*Angstrom,
    symmetries=[
        ([[ 1., 0., 0.],
          [ 0., 1., 0.],
          [ 0., 0., 1.]], [ 0., 0., 0.]),
        ([[-1., 0., 0.],
          [ 0.,-1., 0.],
          [ 0., 0.,-1.]], [ 0., 0., 0.]),
        ],
    force_timereversal=True,
    shift_to_gamma=[True, True, True],
    )
device_exact_exchange_parameters = ExactExchangeParameters(
    aux_basis_tolerance=0.001,
    number_of_waves=1024,
    maximum_wave_vector=50.0,
    integral_tolerance=0.0001,
    relative_screening_tolerance=0.01,
    )
device_numerical_accuracy_parameters = NumericalAccuracyParameters(
    density_mesh_cutoff=60.0*Hartree,
    k_point_sampling=device_k_point_sampling,
    radial_step_size=0.001*Bohr,
    density_cutoff=1e-06,
    interaction_max_range=20.0*Angstrom,
    number_of_reciprocal_points=1024,
    reciprocal_energy_cutoff=1250.0*Hartree,
    occupation_method=FermiDirac(1000.0*Kelvin*boltzmann_constant),
    exact_exchange_parameters=device_exact_exchange_parameters,
    compensation_charge_mesh_cutoff=75.0*Hartree,
    )

#----------------------------------------
# Iteration Control Settings
#----------------------------------------
left_electrode_iteration_control_parameters = IterationControlParameters(
    tolerance=0.0001,
    max_steps=100,
    algorithm=PulayMixer(),
    damping_factor=0.1,
    number_of_history_steps=20,
    start_mixing_after_step=0,
    mixing_variable=HamiltonianVariable,
    preconditioner=Preconditioner.Off,
    linear_dependence_threshold=0.0,
    max_exx_updates=50,
    non_convergence_behavior=ContinueCalculation(),
    enable_scf_stop_file=True,
    )

right_electrode_iteration_control_parameters = IterationControlParameters(
    tolerance=0.0001,
    max_steps=100,
    algorithm=PulayMixer(),
    damping_factor=0.1,
    number_of_history_steps=20,
    start_mixing_after_step=0,
    mixing_variable=HamiltonianVariable,
    preconditioner=Preconditioner.Off,
    linear_dependence_threshold=0.0,
    max_exx_updates=50,
    non_convergence_behavior=ContinueCalculation(),
    enable_scf_stop_file=True,
    )

device_iteration_control_parameters = IterationControlParameters(
    tolerance=0.0001,
    max_steps=100,
    algorithm=PulayMixer(),
    damping_factor=0.1,
    number_of_history_steps=20,
    start_mixing_after_step=0,
    mixing_variable=HamiltonianVariable,
    preconditioner=Preconditioner.Off,
    linear_dependence_threshold=0.0,
    max_exx_updates=50,
    non_convergence_behavior=ContinueCalculation(),
    enable_scf_stop_file=True,
    )

#----------------------------------------
# Poisson Solver Settings
#----------------------------------------
left_electrode_poisson_solver = FastFourier2DSolver(
    boundary_conditions=[[PeriodicBoundaryCondition(),PeriodicBoundaryCondition()],
                         [PeriodicBoundaryCondition(),PeriodicBoundaryCondition()],
                         [PeriodicBoundaryCondition(),PeriodicBoundaryCondition()]],
    order=2
    )

right_electrode_poisson_solver = FastFourier2DSolver(
    boundary_conditions=[[PeriodicBoundaryCondition(),PeriodicBoundaryCondition()],
                         [PeriodicBoundaryCondition(),PeriodicBoundaryCondition()],
                         [PeriodicBoundaryCondition(),PeriodicBoundaryCondition()]],
    order=2
    )

device_poisson_solver = FastFourier2DSolver(
    boundary_conditions=[[PeriodicBoundaryCondition(),PeriodicBoundaryCondition()],
                         [PeriodicBoundaryCondition(),PeriodicBoundaryCondition()],
                         [DirichletBoundaryCondition(),DirichletBoundaryCondition()]],
    order=2
    )

#----------------------------------------
# Contour Integral Settings
#----------------------------------------
equilibrium_contour = SemiCircleContour(
    integral_lower_bound=1.79336700318*Hartree,
    circle_eccentricity=0.3,
    logarithmic_bunching=0.3,
    circle_points=30,
    fermi_line_points=10,
    fermi_function_poles=8,
    )
non_equilibrium_contour = RealAxisContour(
    real_axis_point_density=0.001*Hartree,
    real_axis_infinitesimal=0.001*Hartree,
    real_axis_kbt_padding_factor=5.0,
    )
method = DoubleContour()
contour_parameters = ContourParameters(
    equilibrium_contour=equilibrium_contour,
    non_equilibrium_contour=non_equilibrium_contour,
    method=method,
    )

#----------------------------------------
# Device Algorithm Settings
#----------------------------------------
initial_density_type = NeutralAtom(
    electrode_constraint_length=10.0*Angstrom,
    )

self_energy_calculator_real = RecursionSelfEnergy(
    storage_strategy=SaveInMemory(),
    tolerance=1e-13,
    maximum_iteration=400,
    sparse_threshold=1e-12,
    enable_block_algorithm=True,
    )
self_energy_calculator_complex = RecursionSelfEnergy(
    storage_strategy=SaveInMemory(),
    tolerance=1e-13,
    maximum_iteration=400,
    sparse_threshold=1e-12,
    enable_block_algorithm=True,
    )
non_equilibrium_method = GreensFunction(
    processes_per_contour_point=1,
    )
equilibrium_method = GreensFunction(
    processes_per_contour_point=1,
    )
device_algorithm_parameters = DeviceAlgorithmParameters(
    initial_density_type=initial_density_type,
    electrode_constraint=ElectrodeConstraint.Off,
    self_energy_calculator_real=self_energy_calculator_real,
    self_energy_calculator_complex=self_energy_calculator_complex,
    non_equilibrium_method=non_equilibrium_method,
    equilibrium_method=equilibrium_method,
    store_grids=True,
    store_basis_on_grid=Automatic,
    scf_restart_step_length=0.1*Angstrom,
    enforce_different_electrodes=False,
    )

#----------------------------------------
# Parallel Parameters
#----------------------------------------
parallel_parameters = ParallelParameters(
    processes_per_neb_image=None,
    processes_per_individual=None,
    processes_per_bias_point=None,
    processes_per_saddle_search=1,
    )

#----------------------------------------
# Grimme DFTD3
#----------------------------------------
device_correction_extension = GrimmeDFTD3(
    exchange_correlation=GGA.PBE,
    global_scale_factor_6=1.0,
    damping_factor_6=1.217,
    global_scale_factor_8=0.722,
    damping_factor_8=1.0,
    maximum_neighbour_distance=30.0*Ang,
    include_three_body_term=False,
    )

#----------------------------------------
# Checkpoint Handler
#----------------------------------------
checkpoint_handler = CheckpointHandler(
    time_interval=0.5*Hour,
    )

#----------------------------------------
# Electrode Calculators
#----------------------------------------
left_electrode_calculator = LCAOCalculator(
    basis_set=basis_set,
    exchange_correlation=exchange_correlation,
    numerical_accuracy_parameters=left_electrode_numerical_accuracy_parameters,
    iteration_control_parameters=left_electrode_iteration_control_parameters,
    poisson_solver=left_electrode_poisson_solver,
    checkpoint_handler=checkpoint_handler,
    charge=0,
    )

right_electrode_calculator = LCAOCalculator(
    basis_set=basis_set,
    exchange_correlation=exchange_correlation,
    numerical_accuracy_parameters=right_electrode_numerical_accuracy_parameters,
    iteration_control_parameters=right_electrode_iteration_control_parameters,
    poisson_solver=right_electrode_poisson_solver,
    checkpoint_handler=checkpoint_handler,
    charge=0,
    )

#----------------------------------------
# Device Calculator
#----------------------------------------
calculator = DeviceLCAOCalculator(
    basis_set=basis_set,
    exchange_correlation=exchange_correlation,
    numerical_accuracy_parameters=device_numerical_accuracy_parameters,
    iteration_control_parameters=device_iteration_control_parameters,
    poisson_solver=device_poisson_solver,
    checkpoint_handler=checkpoint_handler,
    correction_extension=device_correction_extension,
    contour_parameters=contour_parameters,
    device_algorithm_parameters=device_algorithm_parameters,
    parallel_parameters=parallel_parameters,
    electrode_calculators=
        [left_electrode_calculator, right_electrode_calculator],
    electrode_voltages=( 0.0*Volt, 0.0*Volt),
    electrode_temperatures=( 300.0*Kelvin, 300.0*Kelvin),
    )

device_configuration.setCalculator(calculator)
nlprint(device_configuration)
device_configuration.update()
nlsave('Device Interface Gold Molybdenite.hdf5', device_configuration)

# -------------------------------------------------------------
# IV Curve
# -------------------------------------------------------------
biases = [0.000000, -0.010000, -0.020000, -0.030000, -0.040000, -0.050000,
          0.010000, 0.020000, 0.030000, 0.040000, 0.050000]*Volt

kpoint_grid = KpointDensity(
    density_a=7.0*Angstrom,
    density_c=0.0*Angstrom,
    )

iv_curve = IVCurve(
    configuration=device_configuration,
    biases=biases,
    energies=numpy.linspace(-2,2,101)*eV,
    kpoints=kpoint_grid,
    self_energy_calculator=RecursionSelfEnergy(),
    energy_zero_parameter=AverageFermiLevel,
    infinitesimal=1e-06*eV,
    selfconsistent_configurations_filename_prefix="ivcurve_selfconsistent_configuration_",
    log_filename_prefix="ivcurve_"
    )
nlsave('Device Interface Gold Molybdenite.hdf5', iv_curve)
nlprint(iv_curve)
